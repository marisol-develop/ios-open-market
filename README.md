# ğŸ›ì˜¤í”ˆë§ˆì¼“

>í”„ë¡œì íŠ¸ ê¸°ê°„ 2022.05.09 ~ 2022.06.03
>
>íŒ€ì› : [marisol](https://github.com/marisol-develop), [Eddy](https://github.com/kimkyunghun3) / ë¦¬ë·°ì–´ : [ë¦°ìƒ](https://github.com/jungseungyeo)

## ëª©ì°¨

- [í”„ë¡œì íŠ¸ ì†Œê°œ](#í”„ë¡œì íŠ¸-ì†Œê°œ)
- [í‚¤ì›Œë“œ](#í‚¤ì›Œë“œ)
- [ê³ ë¯¼í•œì ](#ê³ ë¯¼í•œì )
- [ì˜¤í”ˆë§ˆì¼“I](#ì˜¤í”ˆë§ˆì¼“I)
- [ì˜¤í”ˆë§ˆì¼“II](#ì˜¤í”ˆë§ˆì¼“II)

## í”„ë¡œì íŠ¸ ì†Œê°œ

ì˜¤í”ˆë§ˆì¼“ ë§Œë“¤ê¸°!

## ì‹¤í–‰ í™”ë©´
ì•±ì„ ìµœì´ˆì— ì‹¤í–‰í–ˆì„ ë•Œ ë°ì´í„°ê°€ ë¡œë“œë  ë•Œê¹Œì§€ indicatorë¥¼ ë³´ì—¬ì¤€ë‹¤.

![](https://i.imgur.com/L2pEY3Z.gif)

-----
ë™ì¼í•œ ë°ì´í„°ë¥¼ List, Grid í˜•ì‹ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ë³´ì—¬ì¤€ë‹¤.

![](https://i.imgur.com/vEAQwdy.gif)

-----
ìŠ¤í¬ë¡¤ì„ ë‚´ë¦¬ê²Œ ë˜ë©´ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ í†µí•´ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ë‹¤.

![](https://i.imgur.com/44O40S7.gif)

-----
ìŠ¤í¬ë¡¤ì„ ìœ„ë¡œ ì˜¬ë¦¬ê²Œ ë˜ë©´ refreshë¡œ í†µì‹ ì„ í•´ì„œ ìƒˆ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ë‹¤.

![](https://i.imgur.com/RWtu0o6.gif)

-----
ìƒí’ˆì„ ë“±ë¡í•˜ë©´ POST í˜¸ì¶œì„ í†µí•´ ì„œë²„ì— ë°ì´í„°ë¥¼ ë“±ë¡í•œë‹¤.

![](https://i.imgur.com/LDbf0lB.gif)

-----
ìƒí’ˆ ìˆ˜ì •í•˜ë©´ PATCH í˜¸ì¶œì„ í†µí•´ ì„œë²„ì— ìˆ˜ì •ëœ ë°ì´í„°ë¥¼ ë“±ë¡í•œë‹¤.

![](https://i.imgur.com/CcI7gzE.gif)

-----
ìƒí’ˆ ì‚­ì œí•˜ë©´ DELETE í˜¸ì¶œì„ í†µí•´ ì„œë²„ì—ì„œë„ ë°ì´í„°ë¥¼ ì‚­ì œí•œë‹¤.

![](https://i.imgur.com/orKtQgR.gif)

## ê°œë°œí™˜ê²½ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬
![swift](https://img.shields.io/badge/swift-5.5-orange)
![xcode](https://img.shields.io/badge/Xcode-13.0-blue)
![iOS](https://img.shields.io/badge/iOS-13.0-yellow)

## í‚¤ì›Œë“œ

`git flow` `Test Double` `URLSession` `StubURLSession` `Protocol Oriented Programming` `ì¶”ìƒí™”` `json` `HTTP method` `decode` `escaping closure` `Cache` `CompositionalLayout` `URLSession` `UIImagePickerController`

### ìì„¸í•œ ê³ ë¯¼ ë³´ê¸°

#### [STEP1](https://github.com/yagom-academy/ios-open-market/pull/142)
#### [STEP2](https://github.com/yagom-academy/ios-open-market/pull/153)
#### [STEP3](https://github.com/yagom-academy/ios-open-market/pull/164)
#### [STEP4](https://github.com/yagom-academy/ios-open-market/pull/170)

# ğŸ›ì˜¤í”ˆë§ˆì¼“I

## ğŸ§ ê³ ë¯¼í•œì  & í•´ê²°ë°©ë²•
### ğŸ“Œ 1. URLSessionDataTaskì˜ initì´ deprecatedëœ ë¬¸ì œë¥¼ ì˜ì¡´ì„± ì£¼ì…ìœ¼ë¡œ í•´ê²°

> Responseë¼ëŠ” êµ¬ì¡°ì²´ë¥¼ í™œìš©í•´ì„œ ì˜ì¡´ì„± ì£¼ì…í•˜ì—¬ URLSessionDataTaskë¥¼ ìƒì†ë°›ëŠ” ê²Œ ì•„ë‹ˆë¼ ë§Œë“¤ì–´ì§„ í”„ë¡œí† ì½œ ì£¼ì…ì„ í†µí•´ í•´ê²°í–ˆë‹¤.

```swift
import Foundation

typealias DataTaskCompletionHandler = (Response) -> Void

struct Response {
    var data: Data?
    var statusCode: Int
    var error: Error?
}

protocol URLSessionProtocol {
    func dataTask(with request: URLRequest, completionHandler: @escaping DataTaskCompletionHandler)
    func dataTask(with url: URL, completionHandler: @escaping DataTaskCompletionHandler)
}

extension URLSession: URLSessionProtocol {
    func dataTask(with request: URLRequest, completionHandler: @escaping DataTaskCompletionHandler) {
        
        dataTask(with: request) { data, response, error in
            guard let statusCode = (response as? HTTPURLResponse)?.statusCode else {
                return
            }
            
            let response = Response(data: data, statusCode: statusCode, error: error)
            completionHandler(response)
        }.resume()
    }
    
    func dataTask(with url: URL, completionHandler: @escaping DataTaskCompletionHandler) {
        dataTask(with: url) { data, response, error in
            guard let statusCode = (response as? HTTPURLResponse)?.statusCode else {
                return
            }
            
            let response = Response(data: data, statusCode: statusCode, error: error)
            completionHandler(response)
        }.resume()
    }
}

```

### ğŸ“Œ 2. MockURLSession Unit Test
ê°€ì§œ ë°ì´í„°ë¥¼ í™œìš©í•´ì„œ ë„¤íŠ¸ì›Œí¬ í†µì‹ ì´ ì˜ ë˜ëŠ”ì§€ í™•ì¸

```swift
 func test_Product_dummyë°ì´í„°ì˜_totalCountê°€_10ê³¼_ì¼ì¹˜í•œë‹¤() {
        // given
        let promise = expectation(description: "success")
        var totalCount: Int = 0
        let expectedResult: Int = 10

        guard let product = NSDataAsset(name: "products") else {
            XCTFail("Data í¬ë§·íŒ… ì‹¤íŒ¨")
            return
        }
        
        let response = Response(data: product.data, statusCode: 200, error: nil)
        let dummyData = DummyData(response: response)
        let stubUrlSession = StubURLSession(dummy: dummyData)
        sutProduct.session = stubUrlSession

        // when
        sutProduct.execute(with: FakeAPI()) { result in
            switch result {
            case .success(let product):
                totalCount = product.totalCount
            case .failure(let error):
                XCTFail(error.localizedDescription)
            }
            promise.fulfill()
        }

        wait(for: [promise], timeout: 10)

        // then
        XCTAssertEqual(totalCount, expectedResult)
    }
```

### ğŸ“Œ 3. list cellê³¼ grid cellì— dataSource í™œìš©
 
ì²˜ìŒì— MainViewControllerì˜ makeDataSource ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ë°ì´í„°ë“¤ì„ ê°€ì§€ê³  cellì„ êµ¬ì„±í•´ì£¼ì—ˆëŠ”ë°, ê·¸ë ‡ê²Œ í•˜ë‹¤ë³´ë‹ˆ makeDataSource ë©”ì„œë“œê°€ ë„ˆë¬´ ê¸¸ì–´ì§€ê³  ì—­í•  ë¶„ë¦¬ë„ ì• ë§¤í•´ì¡Œë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤. ê·¸ë˜ì„œ configureCellì´ë¼ëŠ” ë©”ì„œë“œì— íŒŒë¼ë¯¸í„°ë¡œ productë¥¼ ë°›ë„ë¡ í•˜ê³ , cell ë‚´ë¶€ì—ì„œ íŒŒë¼ë¯¸í„°ì˜ product ë°ì´í„°ë¡œ cellì„ êµ¬ì„±í•´ì£¼ë„ë¡ ë³€ê²½í–ˆë‹¤.


> ê°ê° grid, list cellì— ë”°ë¼ Viewì— ì§ì ‘ì ìœ¼ë¡œ ë¿Œë ¤ì£¼ê²Œ ë˜ë©´ Viewì— ë¡œì§ì´ ë” í•„ìš”í•˜ê¸° ë–„ë¬¸ì— Presenterë¼ëŠ” ì¤‘ê°„ ë§¤ì²´ë¥¼ ì‚¬ìš©í–ˆë‹¤. ì´ ê³³ì—ì„œëŠ” cellì—ì„œ í†µì‹ ì„ í†µí•´ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ í™œìš©í•´ì„œ ë·°ì— í•„ìš”í•œ ë¡œì§ë“¤ì„ êµ¬í˜„í–ˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´, ë°ì´í„°í¬ë§·í„°ë¥¼ í†µí•´ ì‰¼í‘œë¥¼ ë„£ì–´ì£¼ê±°ë‚˜ ì¬ê³  ìˆ˜ëŸ‰ìœ ë¬´ì— ë”°ë¼ cellì— ë‹¤ë¥´ê²Œ ë³´ì—¬ì¤˜ì•¼í•˜ëŠ” ë¶€ë¶„ì„ ì²˜ë¦¬í•˜ì—¬ì„œ Viewì—ì„œëŠ” ë³´ì—¬ì£¼ëŠ” ì—­í• ë§Œì„ ìˆ˜í–‰í•˜ë„ë¡ ë¶„ë¦¬í–ˆë‹¤.

### ğŸ“Œ 4. collectionViewì˜ cellì— êµ¬ë¶„ì„ ì„ ê·¸ë¦¬ê¸°

cellë§ˆë‹¤ êµ¬ë¶„ì„ ì„ ì£¼ëŠ” ë°©ë²•ì— ëŒ€í•´ ì˜¤ë˜ ê³ ë¯¼í–ˆë‹¤ ë‹¤ë¥¸ ìº í¼ë“¤ì—ê²Œ ì¡°ì–¸ì„ êµ¬í•´ viewë¥¼ ì–‡ê²Œ ë§Œë“¤ì–´ì„œ ë„£ëŠ” ë°©ë²•ì´ ìˆë‹¤ëŠ” ê²ƒë„ ì•Œê²Œ ë˜ì—ˆê³ , CALayerë¥¼ extensioní•´ì„œ bottomì— êµ¬ë¶„ì„ ì„ ë„£ì–´ì£¼ëŠ” ë°©ë²•ë„ ì•Œê²Œ ë˜ì–´, CALayerë¥¼ extensioní•˜ëŠ” ë°©ë²•ì„ ì±„íƒí–ˆë‹¤.

> cell ì†ì— viewë¥¼ ë„£ì–´ì„œ êµ¬ë¶„ì„ ì„ ë„£ëŠ” ë°©ë²•ì´ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤. í•˜ì§€ë§Œ ì•„ë˜ ì½”ë“œë¡œ CALayerë¥¼ í™•ì¥í•˜ì—¬ ì‚¬ìš©í•˜ë©´ ë” í¸ë¦¬í•˜ë‹¤ê³  íŒë‹¨í•˜ì—¬ ì•„ë˜ì˜ ì½”ë“œë¥¼ ì‚¬ìš©í–ˆë‹¤.
 
```swift=
extension CALayer {
    func addSeparator() {
        let separator = CALayer()
        
        separator.frame = CGRect.init(x: 10, y: frame.height - 0.5, width: frame.width, height: 0.5)
        
        separator.backgroundColor = UIColor.systemGray2.cgColor
        self.addSublayer(separator)
    }
}
```

### ğŸ“Œ 5. modern CollectionViewì˜ ë·°ì˜ ì „í™˜ì„ ë¹„ë™ê¸°ë¡œ êµ¬í˜„
segmentedControlì˜ indexë¥¼ í™œìš©í•´ì„œ ë·°ì˜ ì „í™˜ì„ êµ¬í˜„í–ˆì—ˆë‹¤.
í•˜ì§€ë§Œ ì´ ì½”ë“œëŠ” modern ColletctionViewì—ì„œ ì œê³µí•˜ëŠ” initì˜ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë·°ì˜ ì „í™˜ì„ í™œìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œì˜€ë‹¤.

ê·¸ë¦¬í•˜ì—¬ ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ” initë¥¼ í™œìš©í•´ì„œ ì²˜ë¦¬í•´ë³´ì•˜ë‹¤.
```swift
  public init(sectionProvider: @escaping UICollectionViewCompositionalLayoutSectionProvider,
              configuration: UICollectionViewCompositionalLayoutConfiguration)

```

ì´ initëŠ” ë·° ì•ˆì— ì—¬ëŸ¬ Sectionë“¤ì— ëŒ€í•œ ì „í™˜ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì£¼ë¯€ë¡œ ì´ì „ ì½”ë“œì™€ ë‹¤ë¥´ê²Œ ë” íš¨ìœ¨ì ìœ¼ë¡œ ê°€ëŠ¥í•´ì§„ë‹¤.

ì•„ë˜ì²˜ëŸ¼ êµ¬í˜„í–ˆìœ¼ë©°
```swift
   private lazy var layouts: UICollectionViewCompositionalLayout = {
        return UICollectionViewCompositionalLayout(sectionProvider: { _, _ in
            return LayoutType.section(self.layoutType)()
        }, configuration: .init())
    }()
```

ì´ê³³ì—ì„œ layoutTypeëŠ” enumë¥¼ í™œìš©í•´ì„œ ë‚´ë¶€ë¥¼ ìº¡ìŠí™”í•´ì„œ ì‚¬ìš©í–ˆë‹¤. ê·¸ëŸ¬ë©´ ì™¸ë¶€ì—ì„œì˜ ì ‘ê·¼ë„ í”¼í•  ìˆ˜ ìˆìœ¼ë©° segmentedIndexë¥¼ í™œìš©í•˜ì§€ ì•Šê³ ë„ ë·°ì˜ ë³€í™˜ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆì—ˆë‹¤.

### ğŸ“Œ 6. ì´ë¯¸ì§€ ìºì‹± ì²˜ë¦¬ ë°©ë²•

NSCacheë¥¼ ì‚¬ìš©í•´ì„œ ì´ë¯¸ì§€ë¥¼ ìºì‹±í•˜ë„ë¡ í–ˆë‹¤.

UIImageViewë¥¼ extensioní•´ì„œ `loadImage(_ urlString: String)`ë¼ëŠ” ë©”ì„œë“œë¥¼ ë§Œë“¤ê³ , 
ì´ë¯¸ ìºì‹œì— í•´ë‹¹ urlì˜ ì´ë¯¸ì§€ê°€ ì¡´ì¬í•œë‹¤ë©´ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•˜ê³ , ìºì‹œì— ì—†ëŠ” ì´ë¯¸ì§€ë¼ë©´ í•´ë‹¹ urlë¡œ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ ìºì‹œì— ì €ì¥í•˜ë„ë¡ í–ˆë‹¤.


### ğŸ“Œ 7. ë·°ì˜ ancestor ë¬¸ì œ
ë·°ì˜ ë ˆì´ì•„ì›ƒì„ ì¡ê³  ë¹Œë“œë¥¼ í–ˆì„ ë•Œ ì•„ë˜ì™€ ê°™ì€ ë¬¸ì œê°€ ìì£¼ ë°œìƒí–ˆë‹¤.
> Thread 1: "Unable to activate constraint with anchors <NSLayoutXAxisAnchor:0x6000034dcec0 \"UILabel:0x12260c090.centerX\"> and <NSLayoutXAxisAnchor:0x6000034dcf00 \"UIView:0x12260ab30.centerX\"> because they have no common ancestor. Does the constraint or its anchors reference items in different view hierarchies? That's illegal."

ì´ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ì‹œ 2ê°€ì§€ë¥¼ ê³ ë ¤í•˜ë©´ ëœë‹¤.
1. addSubviewê°€ ì˜ë˜ì–´ìˆëŠ”ì§€
2. addSubview -> Layout Constraint ìˆœìœ¼ë¡œ ì˜í–ˆëŠ”ì§€

### ğŸ“Œ 8. cellì˜ indexPath ë¹„êµ vs cell prepareForReuse

#### prepareForReuse 

- ì…€ì„ ì¬ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œë‹¤
    - CollectionViewì˜ ì¥ì ì€ ì…€ì„ ì¬ì‚¬ìš©í•œë‹¤ëŠ”ê²ƒ. ê·¸ë˜ì„œ ì´ ë©”ì„œë“œê°€ íš¨ìœ¨ì ìœ¼ë¡œ ë°œíœ˜í•  ìˆ˜ ìˆë‹¤.

- ë˜í•œ Object ì±…ì—ì„œ ë§í•˜ê¸¸, "ê°ì²´ì§€í–¥ì—ì„œ ê°ì²´ ì‚¬ì´ì—ì„œ ì„œë¡œì˜ ì •ë³´ë¥¼ ë§ì´ ì•Œìˆ˜ë¡ ì˜ì¡´ ê´€ê³„ê°€ ë†’ì•„ì§„ë‹¤."ê³  í•˜ëŠ”ë°, indexPathê°€ cellì˜ ì •ë³´ë¥¼ ì•„ëŠ” ê²ƒì´ ê°ì²´ ì‚¬ì´ì˜ ì •ë³´ë¥¼ ê³µìœ í•˜ëŠ” ê²ƒì´ê¸° ë–„ë¬¸ì— ì´ëŠ” ì˜ì¡´ê´€ê³„ë¥¼ ë†’ì¼ ìˆ˜ ìˆëŠ” ê²°ê³¼ë¥¼ ì´ˆë˜í•œë‹¤.

- ê°’ì„ ë¶€ë¶„ì ìœ¼ë¡œ updateí•  ìˆ˜ ìˆëŠ” ì¥ì ì´ ì¡´ì¬í•œë‹¤.
 

#### indexPath

- indexPathë¥¼ ì‚¬ìš©í•˜ë©´ ê³ ì •ì ìœ¼ë¡œ updateë¥¼ í•´ì¤„ ìˆ˜ ìˆë‹¤

- ì—¬ê¸°ì—ì„œëŠ” ì¬ì‚¬ìš© ì…€ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ê³ ì •ì ìœ¼ë¡œ ì ì ˆí•œ ê³³ì— ì—…ë°ì´íŠ¸ í•´ì£¼ë¯€ë¡œ ê³ ì •ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤ë©´ ìœ ë¦¬í•  ë“¯ì‹¶ë‹¤.

- í•˜ì§€ë§Œ ì¬ì‚¬ìš©ì„±ì´ ë–¨ì–´ì§€ë¯€ë¡œ ì´ë¥¼ ì£¼ì˜í•´ì•¼í•˜ë©°, ê´€ë¦¬ë¥¼ í•´ì¤„ ìˆ˜ ì—†ëŠ” ë‹¨ì ì´ ì¡´ì¬í•œë‹¤.

> ìœ„ì™€ ê°™ì€ íŠ¹ì„±ì´ ìˆê³ , collectionViewì˜ ì¥ì ì¸ ì¬ì‚¬ìš©ì„±ì„ ì´ìš©í•œ prepareForReuseë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í•˜ì˜€ë‹¤

---

# ğŸ›ì˜¤í”ˆë§ˆì¼“II
## ğŸ§ ê³ ë¯¼í•œì  & í•´ê²°ë°©ë²•
### ğŸ“Œ 1. ê³µí†µ ì½”ë“œì— í”„ë¡œí† ì½œ ê¸°ë³¸ êµ¬í˜„ í™œìš©

ìƒí’ˆ ë“±ë¡í™”ë©´, ìƒí’ˆ ìˆ˜ì •í™”ë©´ View í”„ë¡œí† ì½œ ì¶”ìƒí™”ë¡œ ì¸í•œ ì€ë‹‰í™” ë¶ˆê°€ëŠ¥ ë¬¸ì œ

> í”„ë¡œí† ì½œ ì¶”ìƒí™”ì— ë”°ë¥¸ ì€ë‹‰í™” ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ ë…¸ì¶œë˜ë©´ ì•ˆë˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” ì¶”ìƒí™”ë¥¼ í•˜ë©´ ì•ˆë˜ê³  ì¬ì‚¬ìš©ì„± ìˆìœ¼ë©° ì€ë‹‰í™”ê°€ í•„ìš”í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```swift
protocol Drawable: UIView {
    var entireStackView: UIStackView { get }
    var productInfoStackView: UIStackView { get }
    var priceStackView: UIStackView { get }
    var priceTextField: UITextField { get }
    var segmentedControl: UISegmentedControl { get }
    var productNameTextField: UITextField { get }
    var discountedPriceTextField: UITextField { get }
    var stockTextField: UITextField { get }
    var descriptionTextView: UITextView { get }
    
    func configureView()
    func configurePriceStackView()
    func configureProductInfoStackView()
    func configureEntireStackViewLayout()
    func makeStackView(axis: NSLayoutConstraint.Axis, alignment: UIStackView.Alignment, distribution: UIStackView.Distribution, spacing: CGFloat) -> UIStackView
}
```

### ğŸ“Œ 2. ë‹¤ë¥¸ ë·°ì— í”„ë¡œí¼í‹° ì „ë‹¬í•˜ëŠ” ë°©ë²•

ë‹¤ë¥¸ ë·°ì— í”„ë¡œí¼í‹° ì „ë‹¬ ì‹œ ë™ì¼í•œ ìƒí’ˆì„ ì•Œë ¤ì£¼ê¸° ìœ„í•´ idë¥¼ í™œìš©í•˜ëŠ” ì‹œì ì—ì„œì˜ idê°’ì˜ ì€ë‹‰í™” ë¬¸ì œ

> ProductDetailViewControllerì™€ ProductEditViewControllerê°€ ì´ˆê¸°í™” ë  ë•Œ idì™€ productDetailì„ ë°›ë„ë¡ êµ¬í˜„í•˜ì—¬ ì€ë‹‰í™” ë¬¸ì œ í•´ê²°
```swift
// ProductEditViewController.swift
private let products: Products

init(productDetail: ProductDetail) {
    self.productDetail = productDetail
    super.init(nibName: nil, bundle: nil)
}

// MainViewController.swift
extension MainViewController: UICollectionViewDelegate {
     func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) {
         let productDetailViewController = ProductDetailViewController(products: item[indexPath.row])

         self.navigationController?.pushViewController(productDetailViewController, animated: true)
     }
 }

```

### ğŸ“Œ 3. UIImagePickerì—ì„œ ì„ íƒí•œ ì´ë¯¸ì§€ë¥¼ ìˆœì„œëŒ€ë¡œ ë³´ì—¬ì£¼ëŠ” ë°©ë²•

imageê°€ ì„ íƒë˜ì—ˆì„ë•Œ, `didFinishPickingMediaWithInfo` ë©”ì„œë“œ ë‚´ì—ì„œ 
ì„ íƒëœ ì´ë¯¸ì§€ë¥¼ `imageArrayì—` appendí•œë‹¤.

ê·¸ë¦¬ê³  `cellForItemAt` ë©”ì„œë“œì—ì„œ `imageArray[indexPath.row]`ë²ˆì§¸ ì´ë¯¸ì§€ë¥¼ `button.setImage` í•´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ìˆœì„œëŒ€ë¡œ ë³´ì—¬ì£¼ë„ë¡ êµ¬í˜„í•œë‹¤.


### ğŸ“Œ 4. ì—¬ëŸ¬ ê°œì˜ ImageView ë³´ì—¬ì§€ë„ë¡ í•˜ëŠ” ë°©ë²•
ì´ë¯¸ì§€ ë·°ë¥¼ ì—¬ëŸ¬ê°œ ë“±ë¡ ì‹œ, ê°ê° ë‹¤ë¥¸ ì´ë¯¸ì§€ë·°ê°€ ë‚˜ì˜¤ì§€ ì•ŠëŠ” ì—ëŸ¬ 

> cellForItemAt ë©”ì„œë“œê°€ ë¶ˆë¦´ ë•Œë§ˆë‹¤ cellì— imageViewë¥¼ addSubviewí•´ì£¼ê³ ,
presenterì˜ images ë°°ì—´ ì¤‘ indexPath.row ë²ˆì§¸ì˜ ì´ë¯¸ì§€ë¥¼ í•´ë‹¹ imageViewì˜ imageì— ë„£ì–´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ í•´ê²°í–ˆë‹¤.

```swift
func setImage(_ presenter: Presenter) {
        guard let productImages = presenter.images else {
            return
        }
        
        for image in productImages {
            guard let url = URL(string: image) else {
                return
            }
            
            guard let data = try? Data(contentsOf: url) else {
                return
            }
            
            imageView.image = UIImage(data: data)
            contentView.addSubview(imageView)
        }
    }
```

```swift
func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        guard let cell = collectionView.dequeueReusableCell(withReuseIdentifier: EditViewCell.identifier, for: indexPath) as? EditViewCell else {
            return UICollectionViewCell()
        }
        
        cell.contentView.addSubview(cell.imageView)
        
        guard let imageArray = presenter.images else {
            return UICollectionViewCell()
        }
        
        guard let imageString = imageArray[indexPath.row].url,
              let imageURL = URL(string: imageString),
              let imageData = try? Data(contentsOf: imageURL) else {
            return UICollectionViewCell()
        }
        
        let image = UIImage(data: imageData)
        cell.imageView.image = image

        return cell
    }
```

### ğŸ“Œ 5. ImageView ìš©ëŸ‰ ì‚¬ì´ì¦ˆ ì²´í¬
ì´ë¯¸ì§€ ìš©ëŸ‰ì„ ì²´í¬í•œ í›„ resizeí•˜ì—¬ ì €ì¥í•˜ë„ë¡ í–ˆë‹¤.
ê·¸ëŸ¬ë‚˜ ì‹¤ì œ ë¦¬ì‚¬ì´ì¦ˆí•œ ê²ƒì„ ë³´ê²Œ ë˜ë©´ ìš”êµ¬ì‚¬í•­ ë³´ë‹¤ ë” ì‘ì€ ì´ë¯¸ì§€ í¬ê¸°ê°€ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ë˜ì„œ ì´ë¥¼ ë ˆì´ì•„ì›ƒìœ¼ë¡œ í‚¤ì›Œì„œ ê½‰ì°¨ë„ë¡ í•´ì•¼ í•˜ëŠ” ê²ƒì¸ì§€ ì•„ë‹ˆë©´ ì´ëŒ€ë¡œ ì‘ì•„ì§„ í¬ê¸°ê°€ ì ì ˆí•œ ë°©ë²•ì´ì˜€ëŠ”ì§€ ê³ ë¯¼ë˜ì—ˆë‹¤.

```swift 
// êµ¬í˜„ë¶€ 
extension UIImage {
    func resize(newWidth: CGFloat) -> UIImage {
        let scale = newWidth / self.size.width
        let newHeight = self.size.height * scale

        let size = CGSize(width: newWidth, height: newHeight)
        let renderer = UIGraphicsImageRenderer(size: size)
        let renderedImage = renderer.image { context in
            self.draw(in: CGRect(origin: .zero, size: size))
        }
        
        return renderedImage
    }
    
    func checkImageCapacity() -> Double {
        var capacity: Double = 0.0
        guard let data = self.pngData() else {
            return 0.0
        }
        
        capacity = Double(data.count) / 1024
        
        return capacity
    }
}
```

```swift
// í˜¸ì¶œë¶€
  guard let image = info[UIImagePickerController.InfoKey.editedImage] as? UIImage else {
                return
        }

        let imageCapacity = image.checkImageCapacity()

        if imageCapacity > 300 {
            let resizedImage = image.resize(newWidth: 80)
            self.imageArray.append(resizedImage)

            guard let imageData = resizedImage.jpegData(compressionQuality: 1) else {
                return
            }

            let imageInfo = ImageInfo(fileName: "marisol.jpeg", data: imageData, type: "jpeg")
            self.networkImageArray.append(imageInfo)
        } else {
            self.imageArray.append(image)
            guard let imageData = image.jpegData(compressionQuality: 1) else {
                return
            }

            let imageInfo = ImageInfo(fileName: "marisol.jpeg", data: imageData, type: "jpeg")
            self.networkImageArray.append(imageInfo)
        }
```

> RegistrationViewCellì—ì„œ imageViewì˜ frameì„ cellì˜ widthì™€ heightë¡œ ì„¤ì •í•´ì£¼ì–´ ì´ë¯¸ì§€ê°€ cellì— ê½‰ ì°¨ê²Œ ë‚˜ì˜¤ë„ë¡ í–ˆë‹¤.
```swift
imageView.frame = CGRect(x: 0, y: 0, width: self.frame.size.width, height: self.frame.size.width)
```

### ğŸ“Œ 6. ìƒí’ˆ secret ì¡°íšŒë¥¼ ìœ„í•œ secretPost êµ¬í˜„

DELETE í•˜ê¸° ì „ secretPOSTë¥¼ í˜¸ì¶œ ì‹œì  ë¬¸ì œ, ë˜ ë‹¤ë¥¸ httpMethod ì¼€ì´ìŠ¤ë¡œ ë¶„ë¦¬ ê²°ì • ë¬¸ì œ

> httpMethodëŠ” GET/POST/PATCH/DELETE ì´ë ‡ê²Œ 4ê°œë§Œ ìˆì–´ì•¼ í•œë‹¤ê³  ìƒê°í–ˆê³ ,
POST ë‚´ë¶€ì—ì„œ ë¶„ê¸° ì²˜ë¦¬í•˜ì—¬ êµ¬í˜„í–ˆë‹¤.
ì‹¤ì œ í˜¸ì¶œë¶€ì—ì„œëŠ” CompletionHandlerë¥¼ í™œìš©í•´ì„œ secretPOSTê°€ ì‹¤í–‰ë˜ê³  ì„±ê³µí•œ ê°’ì„ ì´ìš©í•˜ì—¬ DELETEì— í™œìš©í•´ì„œ êµ¬í˜„í–ˆë‹¤.

```swift
mutating private func makePOSTRequest(apiAble: APIable) -> URLRequest? {
        let boundary = generateBoundary()
        
        if let item = apiAble.item {
            let urlString = apiAble.url + apiAble.path
            
            guard let url = URL(string: urlString) else {
                return nil
            }
            
            var request = URLRequest(url: url)
            request.httpMethod = "POST"
            request.addValue("multipart/form-data; boundary=\"\(boundary)\"",
                             forHTTPHeaderField: "Content-Type")
            request.addValue(UserInformation.identifier, forHTTPHeaderField: "identifier")
            request.addValue("eddy123", forHTTPHeaderField: "accessId")
            request.httpBody = createPOSTBody(requestInfo: item, boundary: boundary)
            
            return request
        } else {
            return makeSecretPOSTRequest(apiAble: apiAble)
        }
```


### ğŸ“Œ 7. Viewì˜ ë¡œì§ì„ VCì—ì„œ ì‚¬ìš©í•¨ì— ë”°ë¥¸ ì€ë‹‰í™” ë¬¸ì œ
Viewì—ì„œ ë¡œì§ êµ¬í˜„ì„ í•˜ëŠ” ê²ƒì´ ì˜³ì§€ ì•Šê¸°ì— VCì—ì„œ ë¡œì§ì„ êµ¬í˜„í•˜ë ¤ê³  ë…¸ë ¥í–ˆë‹¤. ê·¸ë ‡ê²Œ í•˜ë‹¤ë³´ë‹ˆ Viewì—ì„œ ë§Œë“  Labelë¥¼ ì ‘ê·¼í•´ì„œ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— ì€ë‹‰í™”ë¥¼ í•  ìˆ˜ ì—†ëŠ” ìƒí™©ì´ ìˆì—ˆëŠ”ë° ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì€ë‹‰í™”ë¥¼ ì‹œë„í•´ì•¼í• ì§€ ê³ ë¯¼í–ˆë‹¤.

```swift
final class ProductDetailView: UIView {
    ...
    private let entireScrollView = UIScrollView()
    private let productImage = UIImageView()
    let stockLabel = UILabel()
    let priceLabel = UILabel()
    let discountedLabel = UILabel()
    let productNameLabel = UILabel()
    private let descriptionTextView = UITextView()
    private let currencyLabel = UILabel()
    let pageControl = UIPageControl()
}
// VC ì‚¬ìš©ì²˜ 
private func configureProductNameUI() {
    productDetailView.productNameLabel.font = UIFont.boldSystemFont(ofSize: 15)
}

private func configureStockUI() {
    productDetailView.stockLabel.textColor = .systemGray2
    }
```

> ì´ëŸ° ê²½ìš° viewì™€ controllerê°€ ëª¨ë‘ í•´ë‹¹ ê°’ì— ì ‘ê·¼í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì—, viewë‹¨ì—ì„œ ê·¸ëŒ€ë¡œ ê°’ì„ ë…¸ì¶œí•˜ë„ë¡ ë‘ì—ˆë‹¤.

### ğŸ“Œ 8. ë„¤íŠ¸ì›Œí¬ ì¶”ìƒí™”

ìš°ì„  ê° ê°ì²´ì˜ ì—­í• ì„ ì•„ë˜ì™€ ê°™ì´ ìƒê°í–ˆë‹¤.
- `ViewController`
    - ì •ë³´ (ex: pageNo, itemsPerPage, productId)ë¥¼ ê°€ì§€ê³  APIableì˜ request ë©”ì„œë“œ í˜¸ì¶œ
- `APIable`
    - VCì—ê²Œ ë°›ì€ ì •ë³´ë¡œ request ë©”ì„œë“œì—ì„œ get / post / patch / delete êµ¬ë¶„í•´ì„œ NetworkManagerì˜ ë©”ì„œë“œ (execute) í˜¸ì¶œ
- `NetworkManager`
    - APIableì—ê²Œ ì „ë‹¬ë°›ì€ host, path, params ë“± ì¡°í•©í•´ì„œ url ìƒì„±
    - urlë¡œ request ë§Œë“¤ì–´ì„œ ë„¤íŠ¸ì›Œí¬ í†µì‹ 
    - í†µì‹ í•œ ê²°ê³¼ë¥¼ VCì— ì „ë‹¬

APIableì„ ë¨¼ì € êµ¬í˜„í–ˆëŠ”ë°, 
VCëŠ” APIableì˜ request ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ë•Œ GETì¸ì§€, POSTì¸ì§€ë¥¼ ì•Œê³  ìˆì„ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì—, request ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ ê°’ì— ë”°ë¼ request ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ httpMethodë¥¼ ì •í•´ì¤˜ì•¼ í•œë‹¤ê³  ìƒê°í–ˆë‹¤.

ê·¸ëŸ°ë° íŒŒë¼ë¯¸í„°ì˜ í˜•ì‹ì´ ë‹¤ì–‘í•˜ë‹¤ë³´ë‹ˆ, APIableì˜ ë³€ìˆ˜ë“¤ê³¼ requestì˜ íŒŒë¼ë¯¸í„° ì¢…ë¥˜ê°€ ë§ì•„ì¡Œë‹¤..

```swift
protocol APIable {
    var method: HTTPMethod? { get }
    var baseUrl: String? { get }
    var listParams: [String: String]? { get }
    var registrationParams: String? { get }
    var updateParams: Int? { get }
    var deleteParams: String? { get }
    var secretParams: String? { get }
    var images: [ImageInfo]? { get }
    
    func request(_ list: [String: String]?, _ registration: String?, _ update: Int?, _ delete: String?, _ secret: String?, completionHandler: @escaping (Result<Any, Error>) -> Void)
}

```

> APIableì—ëŠ” urlì„ ë§Œë“¤ê¸° ìœ„í•œ base url, path, paramsì™€ httpmethodë§Œ ê°€ì§€ê³  ìˆë„ë¡ êµ¬í˜„í–ˆê³ ,
ë“±ë¡, ìƒí’ˆ ìƒì„¸ ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ ë“±ê³¼ ê°™ì€ ìƒí™©ë§ˆë‹¤ APIableì„ ì±„íƒí•˜ëŠ” êµ¬ì¡°ì²´ë¥¼ ë§Œë“¤ì–´ì¤¬ë‹¤.

```swift
protocol APIable {
    var url: String { get }
    var path: String { get }
    var method: HTTPMethod { get }
    var item: Item? { get }
    var params: [String: String]? { get }
    var productId: Int? { get }
    var secret: String? { get }
}

struct List: APIable {
    let url: String = "https://market-training.yagom-academy.kr/"
    let path: String = "api/products"
    let method: HTTPMethod = .get
    let item: Item? = nil
    let pageNo: Int
    let itemsPerPage: Int
    var params: [String: String]? {
        return ["page_no": String(pageNo),
                "items_per_page": String(itemsPerPage)]
    }
    var productId: Int? = nil
    var secret: String? = nil
```


